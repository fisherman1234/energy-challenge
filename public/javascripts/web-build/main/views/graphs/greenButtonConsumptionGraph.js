define(["jquery","underscore","shared/views/base","collections/greenButtonConsumptions"],function(e,t,n,r){return n.extend({initialize:function(e){this.consumption=new r,this.consumption.on("sync",this.doRender,this)},render:function(e){return this.options=e,this.doRender(),this.$el.width(1e3),this.consumption.fetch(),this},doRender:function(){window.a=this.consumption;var e=this.consumption.models.map(function(e){return e.get("consumption")}),n=this.consumption.models.map(function(e){return e.get("fraction")}),r=t.min(e),i=t.max(e),s=(i-r)/4;this.consumption.each(function(e){var t=e.get("consumption");if(t<r+s)return e.set("consumption",1);if(t<r+2*s)return e.set("consumption",2);if(t<r+2*s)return e.set("consumption",3);e.set("consumption",4)});var r=t.min(n),i=t.max(n),s=(i-r)/4;this.consumption.each(function(e){var t=e.get("fraction");if(t<r+s)return e.set("fraction",1);if(t<r+2*s)return e.set("fraction",2);if(t<r+2*s)return e.set("fraction",3);e.set("fraction",4)}),this.$el.dxChart({dataSource:this.consumption.toJSON(),commonSeriesSettings:{type:"spline",argumentField:"date"},series:[{valueField:"consumption",name:"User",type:"bar",color:"orange"},{valueField:"fraction",name:"Green Production %",type:"stepline",color:"green"}],argumentAxis:{grid:{visible:!0}},tooltip:{enabled:!1},valueAxis:[{grid:{visible:!0}}],title:"Consumptions",legend:{verticalAlignment:"bottom",horizontalAlignment:"center"},commonPaneSettings:{border:{visible:!0,right:!1}}})}})});